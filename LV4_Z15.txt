#include <stdio.h>
#define epsilon 0.0001

int main() {
    int visina,sirina,i,j,k,t,z;
    double mat[100][100],avg[100],avgK[100],suma,srednja;
    do{
        printf("Unesite vrijednosti M i N: ");
        scanf("%d %d", &visina, &sirina);
        if(visina<=0||visina>100||sirina<=0||sirina>100) printf("Vrijednosti su van opsega!\n");
    }while(visina<=0||visina>100||sirina<=0||sirina>100);
    
	printf("Unesite clanove matrice:\n");
    for(i=0;i<visina;i++)
        for(j=0;j<sirina;j++)
            scanf("%lf",&mat[i][j]);
    srednja=0;
    for(i=0;i<visina;i++){
        suma=0;
        for(j=0;j<sirina;j++){
            suma+=mat[i][j];
            srednja+=mat[i][j];
        }
        suma/=sirina;
        avg[i]=suma;
    }

    srednja/=(visina*sirina);

    

    for(i=0;i<visina;i=i+1){
        if(avg[i]-srednja>epsilon){
            for(t=i;t<visina-1;t++)
                for(z=0;z<sirina;z++)
                    mat[t][z]=mat[t+1][z];
                
            for(k=i;k<visina-1;k++)avg[k]=avg[k+1];
            visina--;
            i--;
        }
    }
    //kolone:
    for(i=0;i<sirina;i++){
        suma=0;
        for(j=0;j<visina;j++){
            suma+=mat[j][i];
        }
        suma/=visina;
        avgK[i]=suma;
        //printf("%lf ",avgK[i]);
    }
    for(i=0;i<sirina;i=i+1){
        if(avgK[i]-srednja>epsilon){
            for(t=i;t<sirina-1;t++)
                for(z=0;z<visina;z++)
                    mat[z][t]=mat[z][t+1];
                
            for(k=i;k<sirina-1;k++)avgK[k]=avgK[k+1];
            sirina--;
            i--;
        }
    }


    printf("Nakon izbacivanja matrica glasi:\n");
    for(i=0;i<visina;i++){
        for(j=0;j<sirina;j++) printf("%6.1f",mat[i][j]);
        printf("\n");
    }
	return 0;
}
